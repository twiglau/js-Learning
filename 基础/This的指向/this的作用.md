# this 了解

## 为什么需要 this?

- 在常见的编程语言中, 几乎都有 this 这个关键字 (Objective-C中使用的是 self), 但是 JavaScript 中的 this 和常见的面向对象语言中的 this 不太一样
 -常见面向对象的编程语言中, 比如Java, C++, Swift, Dart等等一系列语言中, this 通常只会出现在类的方法中.
 -也就是你需要有一个类, 类中的方法(特别是实例方法) 中, this代表的是当前调用对象.
 -但是JavaScript中的this更加灵活,无论是它出现的位置还是它代表的含义.

## this指向什么?

- this在全局作用域下指向什么?

> 在浏览器中测试就是指向window

- 在函数中呢?

> 所有的函数在被调用时, 都会创建一个执行上下文;
> 这个上下文中记录这函数的调用栈, AO对象等;
> this也是其中的一天记录;
 -this是动态绑定的: 在执行时,才真正的绑定上去

## this指向

- 先来看一个让人困惑的问题:

> 定义一个函数, 我们采用三种不同的方式对它进行调用, 它产生了三种不同的结果

- 这个案例可以给我们什么样的启示呢?

> 1.函数在调用时, JavaScript会默认给this绑定一个值;
> 2.this的绑定和定义的位置(编写的位置)没有关系;
> 3.this的绑定和调用方式以及调用的位置有关系;
> 4.this是运行时被绑定的;

## this的绑定规则

> 1. 默认绑定;
> 2. 隐式绑定;
> 3. 显式绑定;
> 4. new绑定

- 默认绑定: 什么情况下使用默认绑定呢? 独立函数调用
 -独立的函数调用我们可以理解成函数没有被绑定到某个对象上进行调用
- 隐式绑定: 通过某个对象进行调用的
 -也就是它的调用位置中,是通过某个对象发起的函数调用
 -隐式绑定有一个前提条件:

 > 必须在调用的对象内部有一个 对函数的引用(比如一个属性);
 > 如果没有这样的引用, 在进行调用时, 会报找不到该函数的错误;
 > 正是通过这个引用, 间接的将this绑定到了这个对象上

- 如果我们不希望在 对象内部 包含这个函数的引用, 同时又希望在这个对象上进行强制调用, 该怎么做?
 -JavaScript所有的函数都可以使用call和apply方法(这个和Prototype有关)

 > 它们两个的区别不再展开;
 > 其实非常简单, 第一个参数是相同的, 后面的参数, apply为数组, call为参数列表

 -这两个函数的第一个参数都要求是一个对象, 这个对象的作用是什么呢? 就是给this准备的
 -在调用这个函数时,会将this绑定到这个传入的对象上

- new绑定: JavaScript中的函数可以当做一个类的构造函数来使用, 也就是使用new关键字.
- 使用new关键字来调用函数时, 会执行如下的操作:

 > 1.创建一个全新的对象
 > 2.这个新对象会被执行prototype连接
 > 3.这个新对象会绑定到函数调用的this上(this的绑定在这个步骤完成)
 > 4.如果函数没有返回其他对象,表达式会返回这个新对象